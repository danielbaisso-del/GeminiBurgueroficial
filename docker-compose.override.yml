version: '3.8'

services:
  backend:
    image: gemini-burger-backend:local
    container_name: gemini-burger-backend-local
    env_file:
      - ./backend/.env.production
    ports:
      - "3333:3333"
    restart: unless-stopped
    depends_on:
      - db

  frontend:
    image: gemini-burger-frontend:local
    container_name: gemini-burger-frontend-local
    ports:
      - "5173:5173"
    restart: unless-stopped

  db:
    image: mysql:8.0
    container_name: gemini-burger-mysql-local
    environment:
      MYSQL_ROOT_PASSWORD: example
      MYSQL_DATABASE: gemini_burger
      MYSQL_USER: example
      MYSQL_PASSWORD: example
    ports:
      - "3306:3306"
    volumes:
      - db_data:/var/lib/mysql

volumes:
  db_data:

# Usage:
# 1) Ensure images `gemini-burger-backend:local` and `gemini-burger-frontend:local` exist (we built them).
# 2) Copy backend/.env.production.example -> backend/.env.production and edit secrets.
# 3) Run: `docker compose -f docker-compose.override.yml up -d` (or `docker-compose up -d` on older installs).
# 4) Backend: http://localhost:3333/api
# 5) Frontend: http://localhost:5173
